"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const chai_1 = require("chai");
const Assertions_1 = require("./test/Assertions");
const Functions_1 = require("polar-shared/src/util/Functions");
const utils_1 = require("./utils");
const TextHighlightRows_1 = require("./highlights/text/controller/TextHighlightRows");
var date = new Date(Date.parse("2018-05-30T02:47:44.411Z"));
describe('Test computeRectForRow for highlighting text...', function () {
    it('Test with 1 entries', function () {
        var rectElements = [
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 721,
                    "height": 18,
                    "right": 721,
                    "bottom": 22
                },
                element: null
            }
        ];
        var expected = { left: 0, top: 4, width: 721, height: 18, right: 721, bottom: 22 };
        chai_1.assert.deepEqual(TextHighlightRows_1.TextHighlightRows.computeRectForRow(rectElements), expected);
    });
    it('Test with 2 entries', function () {
        var rects = [
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 721,
                    "height": 18,
                    "right": 721,
                    "bottom": 22
                },
                element: null
            },
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 721,
                    "height": 18,
                    "right": 800,
                    "bottom": 50
                },
                element: null
            }
        ];
        var expected = { left: 0, top: 4, width: 800, height: 46, right: 800, bottom: 50 };
        chai_1.assert.deepEqual(TextHighlightRows_1.TextHighlightRows.computeRectForRow(rects), expected);
    });
});
describe('Test computeRows for highlighting text...', function () {
    it('Test with no entries', function () {
        chai_1.assert.deepEqual([], []);
    });
    it('Test with 1 entries', function () {
        var rects = [
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 721,
                    "height": 18,
                    "right": 721,
                    "bottom": 22
                },
                element: null
            }
        ];
        var expected = [
            [{ rect: { left: 0, top: 4, width: 721, height: 18, right: 721, bottom: 22 }, element: null }]
        ];
        chai_1.assert.deepEqual(TextHighlightRows_1.TextHighlightRows.computeRows(rects), expected);
    });
    it('Test with 2 entries and two rows', function () {
        var rectElements = [
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 200,
                    "height": 20,
                    "right": 200,
                    "bottom": 24
                },
                element: null
            },
            {
                rect: {
                    "left": 200,
                    "top": 4,
                    "width": 200,
                    "height": 20,
                    "right": 400,
                    "bottom": 24
                },
                element: null
            }
        ];
        var expected = [
            [
                { rect: { left: 0, top: 4, width: 200, height: 20, right: 200, bottom: 24 }, element: null },
                { rect: { left: 200, top: 4, width: 200, height: 20, right: 400, bottom: 24 }, element: null }
            ]
        ];
        chai_1.assert.deepEqual(TextHighlightRows_1.TextHighlightRows.computeRows(rectElements), expected);
    });
});
describe('Testing for gaps in contiguous rects', function () {
    it('Test with no entries', function () {
        var rects = [
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 721,
                    "height": 18,
                    "right": 721,
                    "bottom": 22
                },
                element: null
            },
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 721,
                    "height": 18,
                    "right": 721,
                    "bottom": 22
                },
                element: null
            },
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 721,
                    "height": 18,
                    "right": 721,
                    "bottom": 22
                },
                element: null
            },
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 721,
                    "height": 18,
                    "right": 721,
                    "bottom": 22
                },
                element: null
            },
            {
                rect: {
                    "left": 0,
                    "top": 4,
                    "width": 297,
                    "height": 18,
                    "right": 297,
                    "bottom": 22
                },
                element: null
            }
        ];
        chai_1.assert.deepEqual(TextHighlightRows_1.TextHighlightRows.computeContiguousRects([]), []);
    });
});
describe('Testing computeContiguousRects.', function () {
    it('Test with no entries', function () {
        chai_1.assert.deepEqual(TextHighlightRows_1.TextHighlightRows.computeContiguousRects([]), []);
    });
    xit('Test with one entry', function () {
        let rects = [
            { rect: { top: 10, left: 10, bottom: 50, right: 50 }, element: null }
        ];
        let expected = [
            {
                "rect": {
                    "left": 10,
                    "top": 10,
                    "right": 50,
                    "bottom": 50,
                    "width": 40,
                    "height": 40
                },
                "rectElements": [
                    {
                        "rect": {
                            "top": 10,
                            "left": 10,
                            "bottom": 50,
                            "right": 50
                        },
                        "element": null
                    }
                ]
            }
        ];
        let actual = TextHighlightRows_1.TextHighlightRows.computeContiguousRects(rects);
        Assertions_1.assertJSON(actual, expected);
    });
    xit('Test with two entries', function () {
        var boundingClientRects = [
            { rect: { top: 10, left: 10, bottom: 20, right: 50 }, element: null },
            { rect: { top: 50, left: 10, bottom: 70, right: 50 }, element: null }
        ];
        var expected = [
            {
                "rect": {
                    "left": 10,
                    "top": 10,
                    "right": 50,
                    "bottom": 50,
                    "width": 40,
                    "height": 40
                },
                "rectElements": [
                    {
                        "rect": {
                            "top": 10,
                            "left": 10,
                            "bottom": 20,
                            "right": 50
                        },
                        "element": null
                    }
                ]
            },
            {
                "rect": {
                    "left": 10,
                    "top": 50,
                    "right": 50,
                    "bottom": 70,
                    "width": 40,
                    "height": 20
                },
                "rectElements": [
                    {
                        "rect": {
                            "top": 50,
                            "left": 10,
                            "bottom": 70,
                            "right": 50
                        },
                        "element": null
                    }
                ]
            }
        ];
        Assertions_1.assertJSON(TextHighlightRows_1.TextHighlightRows.computeContiguousRects(boundingClientRects), expected);
    });
});
describe('Testing createSiblingTupples.', function () {
    it('Test with no entries', function () {
        chai_1.assert.deepEqual(Functions_1.createSiblingTuples([]), []);
    });
    it('Test with 1 entry', function () {
        chai_1.assert.deepEqual(Functions_1.createSiblingTuples([1]), [{ curr: 1, prev: null, next: null }]);
    });
    it('Test with 2 entries', function () {
        chai_1.assert.deepEqual(Functions_1.createSiblingTuples([1, 2]), [
            { curr: 1, prev: null, next: 2 },
            { curr: 2, prev: 1, next: null }
        ]);
    });
    it('Test with 3 entries', function () {
        chai_1.assert.deepEqual(Functions_1.createSiblingTuples([1, 2, 3]), [
            { curr: 1, prev: null, next: 2 },
            { curr: 2, prev: 1, next: 3 },
            { curr: 3, prev: 2, next: null }
        ]);
    });
    it('Test with 4 entries', function () {
        chai_1.assert.deepEqual(Functions_1.createSiblingTuples([1, 2, 3, 4]), [
            { curr: 1, prev: null, next: 2 },
            { curr: 2, prev: 1, next: 3 },
            { curr: 3, prev: 2, next: 4 },
            { curr: 4, prev: 3, next: null }
        ]);
    });
});
describe('Testing bounding client rect utils.', function () {
    it('Test with one element', function () {
        var boundingClientRects = [
            { top: 10, left: 10, bottom: 50, right: 50 }
        ];
        var cbr = utils_1.getBoundingClientRectFromBCRs(boundingClientRects);
        chai_1.assert.deepEqual(cbr, { left: 10, top: 10, bottom: 50, right: 50 });
    });
    it('Test with four elements', function () {
        var boundingClientRects = [
            { top: 10, left: 10, bottom: 50, right: 50 },
            { top: 20, left: 5, bottom: 50, right: 50 },
            { top: 30, left: 10, bottom: 55, right: 50 },
            { top: 40, left: 10, bottom: 50, right: 55 }
        ];
        var cbr = utils_1.getBoundingClientRectFromBCRs(boundingClientRects);
        chai_1.assert.deepEqual(cbr, { left: 5, top: 10, bottom: 55, right: 55 });
    });
});
describe('Testing Delegates', function () {
    it('Test basic functionality', function () {
        class MyDelegate {
            constructor() {
                this.testArg0 = null;
                this.testArg1 = null;
                this.testArg0 = null;
                this.testArg1 = null;
            }
            testFunction(testArg0, testArg1) {
                this.testArg0 = testArg0;
                this.testArg1 = testArg1;
            }
        }
        var delegate0 = new MyDelegate();
        var delegate1 = new MyDelegate();
        var delegator = new utils_1.Delegator([delegate0, delegate1]);
        delegator.apply("testFunction", "hello", "world");
        chai_1.assert.equal(delegate0.testArg0, "hello");
        chai_1.assert.equal(delegate0.testArg1, "world");
        chai_1.assert.equal(delegate1.testArg0, "hello");
        chai_1.assert.equal(delegate1.testArg1, "world");
    });
});
describe('Testing progress computation', function () {
});
describe('testing data serialization', function () {
    xit('Test basic serialization ... both ways.', function () {
    });
});
describe('testing model interaction', function () {
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTWFpblRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJNYWluVGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUVBLCtCQUFvQztBQUVwQyxrREFBNkM7QUFHN0MsK0RBQXNFO0FBQ3RFLG1DQUFpRTtBQUNqRSxzRkFBaUY7QUFTakYsSUFBSSxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQywwQkFBMEIsQ0FBQyxDQUFDLENBQUM7QUFFNUQsUUFBUSxDQUFDLGlEQUFpRCxFQUFFO0lBRXhELEVBQUUsQ0FBQyxxQkFBcUIsRUFBRTtRQUV0QixJQUFJLFlBQVksR0FBRztZQUNmO2dCQUNJLElBQUksRUFBRTtvQkFDRixNQUFNLEVBQUUsQ0FBQztvQkFDVCxLQUFLLEVBQUUsQ0FBQztvQkFDUixPQUFPLEVBQUUsR0FBRztvQkFDWixRQUFRLEVBQUUsRUFBRTtvQkFDWixPQUFPLEVBQUUsR0FBRztvQkFDWixRQUFRLEVBQUUsRUFBRTtpQkFDZjtnQkFDRCxPQUFPLEVBQUUsSUFBSTthQUNoQjtTQUNKLENBQUM7UUFFRixJQUFJLFFBQVEsR0FBRyxFQUFFLElBQUksRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFLENBQUM7UUFFbkYsYUFBTSxDQUFDLFNBQVMsQ0FBQyxxQ0FBaUIsQ0FBQyxpQkFBaUIsQ0FBQyxZQUFZLENBQUMsRUFBRSxRQUFRLENBQUMsQ0FBQztJQUVsRixDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxxQkFBcUIsRUFBRTtRQUV0QixJQUFJLEtBQUssR0FBRztZQUNSO2dCQUNJLElBQUksRUFBRTtvQkFDRixNQUFNLEVBQUUsQ0FBQztvQkFDVCxLQUFLLEVBQUUsQ0FBQztvQkFDUixPQUFPLEVBQUUsR0FBRztvQkFDWixR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QUFTLEVBQUUsU0FBUyxDQUFDLENBQUMsQ0FBQztRQUV0RCxTQUFTLENBQUMsS0FBSyxDQUFDLGNBQWMsRUFBRSxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFFbEQsYUFBTSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQzFDLGFBQU0sQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUUxQyxhQUFNLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxRQUFRLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDMUMsYUFBTSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBRTlDLENBQUMsQ0FBQyxDQUFDO0FBRVAsQ0FBQyxDQUFDLENBQUM7QUFFSCxRQUFRLENBQUMsOEJBQThCLEVBQUU7QUF3QnpDLENBQUMsQ0FBQyxDQUFDO0FBRUgsUUFBUSxDQUFDLDRCQUE0QixFQUFFO0lBRW5DLEdBQUcsQ0FBQyx5Q0FBeUMsRUFBRTtJQW9DL0MsQ0FBQyxDQUFDLENBQUM7QUFFUCxDQUFDLENBQUMsQ0FBQztBQUVILFFBQVEsQ0FBQywyQkFBMkIsRUFBRTtBQWtCdEMsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBhbGwgb3VyIHVuaXQgdGVzdHMuLi5cblxuaW1wb3J0IHthc3NlcnQsIGV4cGVjdH0gZnJvbSAnY2hhaSc7XG5pbXBvcnQgY2hhaSBmcm9tICdjaGFpJztcbmltcG9ydCB7YXNzZXJ0SlNPTn0gZnJvbSAnLi90ZXN0L0Fzc2VydGlvbnMnO1xuaW1wb3J0IHtEb2NNZXRhc30gZnJvbSAnLi9tZXRhZGF0YS9Eb2NNZXRhcyc7XG5pbXBvcnQge0RvY01ldGF9IGZyb20gJy4vbWV0YWRhdGEvRG9jTWV0YSc7XG5pbXBvcnQgeyBjcmVhdGVTaWJsaW5nVHVwbGVzIH0gZnJvbSAncG9sYXItc2hhcmVkL3NyYy91dGlsL0Z1bmN0aW9ucyc7XG5pbXBvcnQge0RlbGVnYXRvciwgZ2V0Qm91bmRpbmdDbGllbnRSZWN0RnJvbUJDUnN9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHtUZXh0SGlnaGxpZ2h0Um93c30gZnJvbSBcIi4vaGlnaGxpZ2h0cy90ZXh0L2NvbnRyb2xsZXIvVGV4dEhpZ2hsaWdodFJvd3NcIjtcblxuXG4vL2ltcG9ydCAqIGFzIHV0aWxzIGZyb20gXCIuL3V0aWxzLmpzXCI7XG5cbi8vY2hhaS5jb25maWcudHJ1bmNhdGVUaHJlc2hvbGQgPSAwO1xuLy9jaGFpLnVzZShjaGFpRGlmZik7XG5cbi8vIHN0YWJsZSByZWZlcmVuY2UgZGF0ZSBmb3IgYWxsIHRlc3RzLlxudmFyIGRhdGUgPSBuZXcgRGF0ZShEYXRlLnBhcnNlKFwiMjAxOC0wNS0zMFQwMjo0Nzo0NC40MTFaXCIpKTtcblxuZGVzY3JpYmUoJ1Rlc3QgY29tcHV0ZVJlY3RGb3JSb3cgZm9yIGhpZ2hsaWdodGluZyB0ZXh0Li4uJywgZnVuY3Rpb24oKSB7XG5cbiAgICBpdCgnVGVzdCB3aXRoIDEgZW50cmllcycsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB2YXIgcmVjdEVsZW1lbnRzID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDQsXG4gICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogNzIxLFxuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAxOCxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA3MjEsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDIyXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBudWxsXG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG5cbiAgICAgICAgdmFyIGV4cGVjdGVkID0geyBsZWZ0OiAwLCB0b3A6IDQsIHdpZHRoOiA3MjEsIGhlaWdodDogMTgsIHJpZ2h0OiA3MjEsIGJvdHRvbTogMjIgfTtcblxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKFRleHRIaWdobGlnaHRSb3dzLmNvbXB1dGVSZWN0Rm9yUm93KHJlY3RFbGVtZW50cyksIGV4cGVjdGVkKTtcblxuICAgIH0pO1xuXG4gICAgaXQoJ1Rlc3Qgd2l0aCAyIGVudHJpZXMnLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdmFyIHJlY3RzID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDQsXG4gICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogNzIxLFxuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAxOCxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA3MjEsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDIyXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBudWxsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDQsXG4gICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogNzIxLFxuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAxOCxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA4MDAsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDUwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBudWxsXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgXTtcblxuICAgICAgICB2YXIgZXhwZWN0ZWQgPSB7IGxlZnQ6IDAsIHRvcDogNCwgd2lkdGg6IDgwMCwgaGVpZ2h0OiA0NiwgcmlnaHQ6IDgwMCwgYm90dG9tOiA1MCB9O1xuXG4gICAgICAgIGFzc2VydC5kZWVwRXF1YWwoVGV4dEhpZ2hsaWdodFJvd3MuY29tcHV0ZVJlY3RGb3JSb3cocmVjdHMpLCBleHBlY3RlZCk7XG5cbiAgICB9KTtcblxufSk7XG5cbmRlc2NyaWJlKCdUZXN0IGNvbXB1dGVSb3dzIGZvciBoaWdobGlnaHRpbmcgdGV4dC4uLicsIGZ1bmN0aW9uKCkge1xuXG4gICAgaXQoJ1Rlc3Qgd2l0aCBubyBlbnRyaWVzJywgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIGFzc2VydC5kZWVwRXF1YWwoW10sIFtdKTtcblxuXG4gICAgfSk7XG5cbiAgICBpdCgnVGVzdCB3aXRoIDEgZW50cmllcycsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB2YXIgcmVjdHMgPSBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmVjdDoge1xuICAgICAgICAgICAgICAgICAgICBcImxlZnRcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgXCJ0b3BcIjogNCxcbiAgICAgICAgICAgICAgICAgICAgXCJ3aWR0aFwiOiA3MjEsXG4gICAgICAgICAgICAgICAgICAgIFwiaGVpZ2h0XCI6IDE4LFxuICAgICAgICAgICAgICAgICAgICBcInJpZ2h0XCI6IDcyMSxcbiAgICAgICAgICAgICAgICAgICAgXCJib3R0b21cIjogMjJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IG51bGxcbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcblxuICAgICAgICB2YXIgZXhwZWN0ZWQgPSBbXG4gICAgICAgICAgICBbIHsgcmVjdDoge2xlZnQ6IDAsIHRvcDogNCwgd2lkdGg6IDcyMSwgaGVpZ2h0OiAxOCwgcmlnaHQ6IDcyMSwgYm90dG9tOiAyMiB9LCBlbGVtZW50OiBudWxsfSBdXG4gICAgICAgIF07XG5cbiAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbChUZXh0SGlnaGxpZ2h0Um93cy5jb21wdXRlUm93cyhyZWN0cyksIGV4cGVjdGVkKTtcblxuXG4gICAgfSk7XG5cbiAgICBpdCgnVGVzdCB3aXRoIDIgZW50cmllcyBhbmQgdHdvIHJvd3MnLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdmFyIHJlY3RFbGVtZW50cyA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgIFwibGVmdFwiOiAwLFxuICAgICAgICAgICAgICAgICAgICBcInRvcFwiOiA0LFxuICAgICAgICAgICAgICAgICAgICBcIndpZHRoXCI6IDIwMCxcbiAgICAgICAgICAgICAgICAgICAgXCJoZWlnaHRcIjogMjAsXG4gICAgICAgICAgICAgICAgICAgIFwicmlnaHRcIjogMjAwLFxuICAgICAgICAgICAgICAgICAgICBcImJvdHRvbVwiOiAyNFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZWxlbWVudDogbnVsbFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgIFwibGVmdFwiOiAyMDAsXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDQsXG4gICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogMjAwLFxuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAyMCxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA0MDAsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDI0XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBudWxsXG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG5cbiAgICAgICAgdmFyIGV4cGVjdGVkID0gW1xuICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgIHsgcmVjdDogeyBsZWZ0OiAwLCB0b3A6IDQsIHdpZHRoOiAyMDAsIGhlaWdodDogMjAsIHJpZ2h0OiAyMDAsIGJvdHRvbTogMjR9LCBlbGVtZW50OiBudWxsIH0sXG4gICAgICAgICAgICAgICAgeyByZWN0OiB7IGxlZnQ6IDIwMCwgdG9wOiA0LCB3aWR0aDogMjAwLCBoZWlnaHQ6IDIwLCByaWdodDogNDAwLCBib3R0b206IDI0fSwgZWxlbWVudDogbnVsbCB9XG4gICAgICAgICAgICBdXG4gICAgICAgIF07XG5cbiAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbChUZXh0SGlnaGxpZ2h0Um93cy5jb21wdXRlUm93cyhyZWN0RWxlbWVudHMpLCBleHBlY3RlZCk7XG5cbiAgICB9KTtcblxuXG5cbn0pXG5cblxuZGVzY3JpYmUoJ1Rlc3RpbmcgZm9yIGdhcHMgaW4gY29udGlndW91cyByZWN0cycsIGZ1bmN0aW9uKCkge1xuXG4gICAgaXQoJ1Rlc3Qgd2l0aCBubyBlbnRyaWVzJywgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIC8vIEZJWE1FOiBicmVhayB0aGlzIG91dCBpbnRvIGEgcmVhbCB0ZXN0Li4uXG5cbiAgICAgICAgdmFyIHJlY3RzID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDQsXG4gICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogNzIxLFxuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAxOCxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA3MjEsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDIyXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBudWxsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDQsXG4gICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogNzIxLFxuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAxOCxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA3MjEsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDIyXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBudWxsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDQsXG4gICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogNzIxLFxuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAxOCxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA3MjEsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDIyXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBudWxsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDQsXG4gICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogNzIxLFxuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAxOCxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA3MjEsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDIyXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBudWxsXG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmVjdDoge1xuICAgICAgICAgICAgICAgICAgICBcImxlZnRcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgXCJ0b3BcIjogNCxcbiAgICAgICAgICAgICAgICAgICAgXCJ3aWR0aFwiOiAyOTcsXG4gICAgICAgICAgICAgICAgICAgIFwiaGVpZ2h0XCI6IDE4LFxuICAgICAgICAgICAgICAgICAgICBcInJpZ2h0XCI6IDI5NyxcbiAgICAgICAgICAgICAgICAgICAgXCJib3R0b21cIjogMjJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IG51bGxcbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcblxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKFRleHRIaWdobGlnaHRSb3dzLmNvbXB1dGVDb250aWd1b3VzUmVjdHMoW10pLCBbXSk7XG5cbiAgICB9KTtcblxufSlcblxuZGVzY3JpYmUoJ1Rlc3RpbmcgY29tcHV0ZUNvbnRpZ3VvdXNSZWN0cy4nLCBmdW5jdGlvbigpIHtcblxuICAgIGl0KCdUZXN0IHdpdGggbm8gZW50cmllcycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbChUZXh0SGlnaGxpZ2h0Um93cy5jb21wdXRlQ29udGlndW91c1JlY3RzKFtdKSwgW10pO1xuICAgIH0pO1xuXG4gICAgeGl0KCdUZXN0IHdpdGggb25lIGVudHJ5JywgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIGxldCByZWN0cyA9IFtcbiAgICAgICAgICAgIHsgcmVjdDoge3RvcDogMTAsIGxlZnQ6IDEwLCBib3R0b206IDUwLCByaWdodDogNTB9LCBlbGVtZW50OiBudWxsIH1cbiAgICAgICAgXTtcblxuICAgICAgICBsZXQgZXhwZWN0ZWQgPSBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgXCJyZWN0XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDEwLFxuICAgICAgICAgICAgICAgICAgICBcInRvcFwiOiAxMCxcbiAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA1MCxcbiAgICAgICAgICAgICAgICAgICAgXCJib3R0b21cIjogNTAsXG4gICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogNDAsXG4gICAgICAgICAgICAgICAgICAgIFwiaGVpZ2h0XCI6IDQwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcInJlY3RFbGVtZW50c1wiOiBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVjdFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0b3BcIjogMTAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IDEwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDUwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicmlnaHRcIjogNTBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcImVsZW1lbnRcIjogbnVsbFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuXG4gICAgICAgIGxldCBhY3R1YWwgPSBUZXh0SGlnaGxpZ2h0Um93cy5jb21wdXRlQ29udGlndW91c1JlY3RzKHJlY3RzKTtcblxuICAgICAgICBhc3NlcnRKU09OKGFjdHVhbCwgZXhwZWN0ZWQpO1xuXG4gICAgfSk7XG5cbiAgICB4aXQoJ1Rlc3Qgd2l0aCB0d28gZW50cmllcycsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB2YXIgYm91bmRpbmdDbGllbnRSZWN0cyA9IFtcbiAgICAgICAgICAgIHtyZWN0OiB7dG9wOiAxMCwgbGVmdDogMTAsIGJvdHRvbTogMjAsIHJpZ2h0OiA1MH0sIGVsZW1lbnQ6IG51bGwgfSxcbiAgICAgICAgICAgIHtyZWN0OiB7dG9wOiA1MCwgbGVmdDogMTAsIGJvdHRvbTogNzAsIHJpZ2h0OiA1MH0sIGVsZW1lbnQ6IG51bGwgfVxuICAgICAgICBdO1xuXG4gICAgICAgIHZhciBleHBlY3RlZCA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBcInJlY3RcIjoge1xuICAgICAgICAgICAgICAgICAgICBcImxlZnRcIjogMTAsXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDEwLFxuICAgICAgICAgICAgICAgICAgICBcInJpZ2h0XCI6IDUwLFxuICAgICAgICAgICAgICAgICAgICBcImJvdHRvbVwiOiA1MCxcbiAgICAgICAgICAgICAgICAgICAgXCJ3aWR0aFwiOiA0MCxcbiAgICAgICAgICAgICAgICAgICAgXCJoZWlnaHRcIjogNDBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwicmVjdEVsZW1lbnRzXCI6IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWN0XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRvcFwiOiAxMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxlZnRcIjogMTAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJib3R0b21cIjogMjAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJyaWdodFwiOiA1MFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZWxlbWVudFwiOiBudWxsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIFwicmVjdFwiOiB7XG4gICAgICAgICAgICAgICAgICAgIFwibGVmdFwiOiAxMCxcbiAgICAgICAgICAgICAgICAgICAgXCJ0b3BcIjogNTAsXG4gICAgICAgICAgICAgICAgICAgIFwicmlnaHRcIjogNTAsXG4gICAgICAgICAgICAgICAgICAgIFwiYm90dG9tXCI6IDcwLFxuICAgICAgICAgICAgICAgICAgICBcIndpZHRoXCI6IDQwLFxuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAyMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJyZWN0RWxlbWVudHNcIjogW1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlY3RcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDUwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGVmdFwiOiAxMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJvdHRvbVwiOiA3MCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJpZ2h0XCI6IDUwXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbGVtZW50XCI6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcblxuICAgICAgICBhc3NlcnRKU09OKFRleHRIaWdobGlnaHRSb3dzLmNvbXB1dGVDb250aWd1b3VzUmVjdHMoYm91bmRpbmdDbGllbnRSZWN0cyksIGV4cGVjdGVkKTtcblxuICAgIH0pO1xuXG59KTtcblxuZGVzY3JpYmUoJ1Rlc3RpbmcgY3JlYXRlU2libGluZ1R1cHBsZXMuJywgZnVuY3Rpb24oKSB7XG5cbiAgICBpdCgnVGVzdCB3aXRoIG5vIGVudHJpZXMnLCBmdW5jdGlvbigpIHtcblxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKCBjcmVhdGVTaWJsaW5nVHVwbGVzKFtdKSwgW10pO1xuXG4gICAgfSk7XG5cbiAgICBpdCgnVGVzdCB3aXRoIDEgZW50cnknLCBmdW5jdGlvbigpIHtcblxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKCBjcmVhdGVTaWJsaW5nVHVwbGVzKFsxXSksIFsgeyBjdXJyOiAxLCBwcmV2OiBudWxsLCBuZXh0OiBudWxsIH0gXSk7XG5cbiAgICB9KTtcblxuICAgIGl0KCdUZXN0IHdpdGggMiBlbnRyaWVzJywgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbCggY3JlYXRlU2libGluZ1R1cGxlcyhbMSwyXSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgY3VycjogMSwgcHJldjogbnVsbCwgbmV4dDogMiB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBjdXJyOiAyLCBwcmV2OiAxLCBuZXh0OiBudWxsIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgXSk7XG5cbiAgICB9KTtcblxuICAgIGl0KCdUZXN0IHdpdGggMyBlbnRyaWVzJywgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbCggY3JlYXRlU2libGluZ1R1cGxlcyhbMSwyLDNdKSxcbiAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICB7IGN1cnI6IDEsIHByZXY6IG51bGwsIG5leHQ6IDIgfSxcbiAgICAgICAgICAgICAgICB7IGN1cnI6IDIsIHByZXY6IDEsIG5leHQ6IDMgfSxcbiAgICAgICAgICAgICAgICB7IGN1cnI6IDMsIHByZXY6IDIsIG5leHQ6IG51bGwgfVxuICAgICAgICAgICAgXSk7XG5cbiAgICB9KTtcblxuICAgIGl0KCdUZXN0IHdpdGggNCBlbnRyaWVzJywgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbCggY3JlYXRlU2libGluZ1R1cGxlcyhbMSwyLDMsNF0pLFxuICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgIHsgY3VycjogMSwgcHJldjogbnVsbCwgbmV4dDogMiB9LFxuICAgICAgICAgICAgICAgIHsgY3VycjogMiwgcHJldjogMSwgbmV4dDogMyB9LFxuICAgICAgICAgICAgICAgIHsgY3VycjogMywgcHJldjogMiwgbmV4dDogNCB9LFxuICAgICAgICAgICAgICAgIHsgY3VycjogNCwgcHJldjogMywgbmV4dDogbnVsbCB9XG4gICAgICAgICAgICBdKTtcblxuICAgIH0pO1xuXG5cbn0pO1xuXG5kZXNjcmliZSgnVGVzdGluZyBib3VuZGluZyBjbGllbnQgcmVjdCB1dGlscy4nLCBmdW5jdGlvbigpIHtcblxuICAgIGl0KCdUZXN0IHdpdGggb25lIGVsZW1lbnQnLCBmdW5jdGlvbigpIHtcblxuICAgICAgICB2YXIgYm91bmRpbmdDbGllbnRSZWN0cyA9IFtcbiAgICAgICAgICAgIHt0b3A6IDEwLCBsZWZ0OiAxMCwgYm90dG9tOiA1MCwgcmlnaHQ6IDUwfVxuICAgICAgICBdO1xuXG4gICAgICAgIHZhciBjYnIgPSBnZXRCb3VuZGluZ0NsaWVudFJlY3RGcm9tQkNScyhib3VuZGluZ0NsaWVudFJlY3RzKTtcblxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKGNiciwgeyBsZWZ0OiAxMCwgdG9wOiAxMCwgYm90dG9tOiA1MCwgcmlnaHQ6IDUwIH0pO1xuXG4gICAgfSk7XG5cbiAgICBpdCgnVGVzdCB3aXRoIGZvdXIgZWxlbWVudHMnLCBmdW5jdGlvbigpIHtcblxuICAgICAgICB2YXIgYm91bmRpbmdDbGllbnRSZWN0cyA9IFtcbiAgICAgICAgICAgIHt0b3A6IDEwLCBsZWZ0OiAxMCwgYm90dG9tOiA1MCwgcmlnaHQ6IDUwfSxcbiAgICAgICAgICAgIHt0b3A6IDIwLCBsZWZ0OiA1LCAgYm90dG9tOiA1MCwgcmlnaHQ6IDUwfSxcbiAgICAgICAgICAgIHt0b3A6IDMwLCBsZWZ0OiAxMCwgYm90dG9tOiA1NSwgcmlnaHQ6IDUwfSxcbiAgICAgICAgICAgIHt0b3A6IDQwLCBsZWZ0OiAxMCwgYm90dG9tOiA1MCwgcmlnaHQ6IDU1fVxuICAgICAgICBdO1xuXG4gICAgICAgIHZhciBjYnIgPSBnZXRCb3VuZGluZ0NsaWVudFJlY3RGcm9tQkNScyhib3VuZGluZ0NsaWVudFJlY3RzKTtcblxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKGNiciwgeyBsZWZ0OiA1LCB0b3A6IDEwLCBib3R0b206IDU1LCByaWdodDogNTUgfSk7XG5cbiAgICB9KTtcblxufSk7XG5cblxuZGVzY3JpYmUoJ1Rlc3RpbmcgRGVsZWdhdGVzJywgZnVuY3Rpb24oKSB7XG5cbiAgICBpdCgnVGVzdCBiYXNpYyBmdW5jdGlvbmFsaXR5JywgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgY2xhc3MgTXlEZWxlZ2F0ZSB7XG5cbiAgICAgICAgICAgIHRlc3RBcmcwOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgICAgICAgICAgIHRlc3RBcmcxOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblxuXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRlc3RBcmcwID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLnRlc3RBcmcxID0gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGVzdEZ1bmN0aW9uKHRlc3RBcmcwOiBzdHJpbmcsIHRlc3RBcmcxOiBzdHJpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRlc3RBcmcwID0gdGVzdEFyZzA7XG4gICAgICAgICAgICAgICAgdGhpcy50ZXN0QXJnMSA9IHRlc3RBcmcxO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZGVsZWdhdGUwID0gbmV3IE15RGVsZWdhdGUoKTtcbiAgICAgICAgdmFyIGRlbGVnYXRlMSA9IG5ldyBNeURlbGVnYXRlKCk7XG5cbiAgICAgICAgdmFyIGRlbGVnYXRvciA9IG5ldyBEZWxlZ2F0b3IoW2RlbGVnYXRlMCwgZGVsZWdhdGUxXSk7XG5cbiAgICAgICAgZGVsZWdhdG9yLmFwcGx5KFwidGVzdEZ1bmN0aW9uXCIsIFwiaGVsbG9cIiwgXCJ3b3JsZFwiKTtcblxuICAgICAgICBhc3NlcnQuZXF1YWwoZGVsZWdhdGUwLnRlc3RBcmcwLCBcImhlbGxvXCIpO1xuICAgICAgICBhc3NlcnQuZXF1YWwoZGVsZWdhdGUwLnRlc3RBcmcxLCBcIndvcmxkXCIpO1xuXG4gICAgICAgIGFzc2VydC5lcXVhbChkZWxlZ2F0ZTEudGVzdEFyZzAsIFwiaGVsbG9cIik7XG4gICAgICAgIGFzc2VydC5lcXVhbChkZWxlZ2F0ZTEudGVzdEFyZzEsIFwid29ybGRcIik7XG5cbiAgICB9KTtcblxufSk7XG5cbmRlc2NyaWJlKCdUZXN0aW5nIHByb2dyZXNzIGNvbXB1dGF0aW9uJywgZnVuY3Rpb24oKSB7XG5cbiAgICAvLyB4aXQoJ0NvbXB1dGUgYmFzaWMgcHJvZ3Jlc3MnLCBmdW5jdGlvbigpIHtcbiAgICAvL1xuICAgIC8vICAgICBsZXQgZG9jTWV0YSA9IERvY01ldGFzLmNyZWF0ZVdpdGhpbkluaXRpYWxQYWdlbWFya3MoXCIweDAwMDBcIiwgMTApO1xuICAgIC8vXG4gICAgLy8gICAgIGxldCB3ZWJWaWV3ID0gbmV3IFdlYlZpZXcoKTtcbiAgICAvLyAgICAgbGV0IHByb2dyZXNzID0gd2ViVmlldy5jb21wdXRlUHJvZ3Jlc3MoZG9jTWV0YSk7XG4gICAgLy9cbiAgICAvLyAgICAgYXNzZXJ0LmVxdWFsKHByb2dyZXNzLCAwLjMpO1xuICAgIC8vXG4gICAgLy8gfSk7XG4gICAgLy9cbiAgICAvLyB4aXQoJ0NvbXB1dGUgYmFzaWMgcHJvZ3Jlc3MgYXQgMTAwIHBlcmNlbnQnLCBmdW5jdGlvbigpIHtcbiAgICAvL1xuICAgIC8vICAgICBsZXQgZG9jTWV0YSA9IERvY01ldGFzLmNyZWF0ZVdpdGhpbkluaXRpYWxQYWdlbWFya3MoXCIweDAwMDBcIiwgMyk7XG4gICAgLy9cbiAgICAvLyAgICAgbGV0IHdlYlZpZXcgPSBuZXcgV2ViVmlldygpO1xuICAgIC8vICAgICBsZXQgcHJvZ3Jlc3MgPSB3ZWJWaWV3LmNvbXB1dGVQcm9ncmVzcyhkb2NNZXRhKTtcbiAgICAvL1xuICAgIC8vICAgICBhc3NlcnQuZXF1YWwocHJvZ3Jlc3MsIDEuMCk7XG4gICAgLy9cbiAgICAvLyB9KTtcblxufSk7XG5cbmRlc2NyaWJlKCd0ZXN0aW5nIGRhdGEgc2VyaWFsaXphdGlvbicsIGZ1bmN0aW9uKCkge1xuXG4gICAgeGl0KCdUZXN0IGJhc2ljIHNlcmlhbGl6YXRpb24gLi4uIGJvdGggd2F5cy4nLCBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gbGV0IGZpbmdlcnByaW50ID0gXCIweGRlY2FmYmFkXCI7XG4gICAgICAgIC8vXG4gICAgICAgIC8vIGxldCBkb2NNZXRhID0gRG9jTWV0YXMuY3JlYXRlKGZpbmdlcnByaW50LCAyKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gbGV0IHNlcmlhbGl6ZWQgPSBNZXRhZGF0YVNlcmlhbGl6ZXIuc2VyaWFsaXplKGRvY01ldGEsIFwiICBcIik7XG4gICAgICAgIC8vXG4gICAgICAgIC8vIGFzc2VydEpTT04oc2VyaWFsaXplZCwgXCJ7XFxuXCIgK1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIFwiICBcXFwiZG9jSW5mb1xcXCI6IHtcXG5cIiArXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgXCIgICAgXFxcInRpdGxlXFxcIjogbnVsbCxcXG5cIiArXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgXCIgICAgXFxcInVybFxcXCI6IG51bGwsXFxuXCIgK1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIFwiICAgIFxcXCJuclBhZ2VzXFxcIjogMixcXG5cIiArXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgXCIgICAgXFxcImZpbmdlcnByaW50XFxcIjogXFxcIjB4ZGVjYWZiYWRcXFwiXFxuXCIgK1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIFwiICB9LFxcblwiICtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICBcIiAgXFxcInBhZ2VNZXRhc1xcXCI6IHtcXG5cIiArXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgXCIgICAgXFxcIjFcXFwiOiB7XFxuXCIgK1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIFwiICAgICAgXFxcInBhZ2VJbmZvXFxcIjoge1xcblwiICtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICBcIiAgICAgICAgXFxcIm51bVxcXCI6IDFcXG5cIiArXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgXCIgICAgICB9LFxcblwiICtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICBcIiAgICAgIFxcXCJwYWdlbWFya3NcXFwiOiB7fVxcblwiICtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICBcIiAgICB9LFxcblwiICtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICBcIiAgICBcXFwiMlxcXCI6IHtcXG5cIiArXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgXCIgICAgICBcXFwicGFnZUluZm9cXFwiOiB7XFxuXCIgK1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIFwiICAgICAgICBcXFwibnVtXFxcIjogMlxcblwiICtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICBcIiAgICAgIH0sXFxuXCIgK1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIFwiICAgICAgXFxcInBhZ2VtYXJrc1xcXCI6IHt9XFxuXCIgK1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIFwiICAgIH1cXG5cIiArXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgXCIgIH0sXFxuXCIgK1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIFwiICBcXFwidmVyc2lvblxcXCI6IDFcXG5cIiArXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgXCJ9XCIpO1xuICAgICAgICAvL1xuICAgICAgICAvLyBsZXQgZG9jTWV0YURlc2VyaWFsaXplZCA9IE1ldGFkYXRhU2VyaWFsaXplci5kZXNlcmlhbGl6ZShuZXcgRG9jTWV0YSgpLCBzZXJpYWxpemVkKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gZXhwZWN0KGRvY01ldGFEZXNlcmlhbGl6ZWQpLnRvLmRlZXAuZXF1YWwoZG9jTWV0YSk7XG5cblxuICAgIH0pO1xuXG59KTtcblxuZGVzY3JpYmUoJ3Rlc3RpbmcgbW9kZWwgaW50ZXJhY3Rpb24nLCBmdW5jdGlvbigpIHtcblxuXG4gICAgLy8gaXQoJ1Rlc3QgY29tcHV0ZSBpbml0aWFsIC4nLCBhc3luYyBmdW5jdGlvbigpIHtcbiAgICAvL1xuICAgIC8vICAgICB2YXIgY2xvY2sgPSBuZXcgU3ludGhldGljQ2xvY2soKTtcbiAgICAvLyAgICAgdmFyIGRhdGFzdG9yZSA9IG5ldyBNZW1vcnlEYXRhc3RvcmUoKTtcbiAgICAvLyAgICAgdmFyIG1vZGVsID0gbmV3IE1vZGVsKGRhdGFzdG9yZSwgY2xvY2spO1xuICAgIC8vICAgICB2YXIgdmlldyA9IG5ldyBNb2NrVmlldyhtb2RlbCk7XG4gICAgLy9cbiAgICAvLyAgICAgbGV0IGZpbmdlcnByaW50ID0gXCJmYWtlLWZpbmdlcnByaW50XCI7XG4gICAgLy9cbiAgICAvLyAgICAgdmFyIGRvY01ldGEgPSBhd2FpdCBtb2RlbC5kb2N1bWVudExvYWRlZChmaW5nZXJwcmludCwgMSk7XG4gICAgLy9cbiAgICAvLyAgICAgYXNzZXJ0LmVxdWFsKG1vZGVsLmNvbXB1dGVJbml0aWFsUGFnZW1hcmtQYWdlTnVtYmVycyhkb2NNZXRhLCAxKSxcbiAgICAvLyBbXSk7ICB9KTtcblxuXG59KTtcblxuLy8gYXNzZXJ0LmRlZXBKU09OID0gZnVuY3Rpb24oYWN0dWFsLGV4cGVjdGVkKSB7XG4vL1xuLy8gICAgIC8vIGZpcnN0IGNvbnZlcnQgYm90aCB0byBKU09OIGlmIG5lY2Vzc2FyeS5cbi8vICAgICBhY3R1YWwgPSB0b0pTT04oYWN0dWFsKTtcbi8vICAgICBleHBlY3RlZCA9IHRvSlNPTihleHBlY3RlZCk7XG4vL1xuLy8gICAgIGlmICggYWN0dWFsICE9PSBleHBlY3RlZCkge1xuLy8gICAgICAgICBjb25zb2xlLmVycm9yKFwiVGhlIGZvbGxvd2luZyBjb250ZW50IHdhcyBub3QgZXhwZWN0ZWQ6IFwiKTtcbi8vICAgICAgICAgY29uc29sZS5lcnJvcihhY3R1YWwpO1xuLy8gICAgIH1cbi8vXG4vLyAgICAgLy9hc3NlcnQuZXF1YWwoYWN0dWFsLGV4cGVjdGVkKTtcbi8vXG4vLyAgICAgZXhwZWN0KGV4cGVjdGVkKS5ub3QuZGlmZmVyZW50RnJvbShhY3R1YWwpO1xuLy9cbi8vIH1cbi8vXG4vLyBmdW5jdGlvbiB0b0pTT04ob2JqKSB7XG4vL1xuLy8gICAgIGlmKHR5cGVvZiBvYmogPT09IFwic3RyaW5nXCIpIHtcbi8vICAgICAgICAgcmV0dXJuIG9iajtcbi8vICAgICB9XG4vL1xuLy8gICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShvYmosIG51bGwsIFwiICBcIik7XG4vL1xuLy8gfVxuIl19