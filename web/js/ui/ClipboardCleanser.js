"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Ranges_1 = require("../highlights/text/selection/Ranges");
class ClipboardCleanser {
    static register() {
        document.addEventListener('cut', event => this.handleCutOrCopy(event));
        document.addEventListener('copy', event => this.handleCutOrCopy(event));
    }
    static handleCutOrCopy(event) {
        if (!event.clipboardData) {
            return;
        }
        const sel = window.getSelection();
        if (!sel) {
            return;
        }
        if (sel.rangeCount <= 0) {
            return;
        }
        const text = Ranges_1.Ranges.toText(sel.getRangeAt(0));
        event.clipboardData.setData('text/plain', text);
        event.clipboardData.setData('text/html', text);
        event.clipboardData.setData('pasted-from-polar', 'true');
        event.preventDefault();
    }
}
exports.ClipboardCleanser = ClipboardCleanser;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ2xpcGJvYXJkQ2xlYW5zZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJDbGlwYm9hcmRDbGVhbnNlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUlBLGdFQUEyRDtBQUUzRCxNQUFhLGlCQUFpQjtJQUVuQixNQUFNLENBQUMsUUFBUTtRQUVsQixRQUFRLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQ3ZFLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUUsS0FBSyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFFNUUsQ0FBQztJQUVPLE1BQU0sQ0FBQyxlQUFlLENBQUMsS0FBcUI7UUFFaEQsSUFBSSxDQUFDLEtBQUssQ0FBQyxhQUFhLEVBQUU7WUFDdEIsT0FBTztTQUNWO1FBRUQsTUFBTSxHQUFHLEdBQUcsTUFBTSxDQUFDLFlBQVksRUFBRSxDQUFDO1FBRWxDLElBQUksQ0FBRSxHQUFHLEVBQUU7WUFDUCxPQUFPO1NBQ1Y7UUFFRCxJQUFJLEdBQUcsQ0FBQyxVQUFVLElBQUksQ0FBQyxFQUFFO1lBRXJCLE9BQU87U0FDVjtRQUVELE1BQU0sSUFBSSxHQUFHLGVBQU0sQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRTlDLEtBQUssQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLFlBQVksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNoRCxLQUFLLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDL0MsS0FBSyxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsbUJBQW1CLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDekQsS0FBSyxDQUFDLGNBQWMsRUFBRSxDQUFDO0lBRTNCLENBQUM7Q0FFSjtBQW5DRCw4Q0FtQ0MiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEtlZXBzIHRyYWNrIG9mIHRoZSBsYXN0IGNvcHkgdGhlIHVzZXIgZGlkIHNvIHRoYXQgd2UgY2FuIHRoZW4gcmVxdWVzdCB3aGF0XG4gKiB3YXMgY29waWVkLlxuICovXG5pbXBvcnQge1Jhbmdlc30gZnJvbSAnLi4vaGlnaGxpZ2h0cy90ZXh0L3NlbGVjdGlvbi9SYW5nZXMnO1xuXG5leHBvcnQgY2xhc3MgQ2xpcGJvYXJkQ2xlYW5zZXIge1xuXG4gICAgcHVibGljIHN0YXRpYyByZWdpc3RlcigpIHtcblxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjdXQnLCBldmVudCA9PiB0aGlzLmhhbmRsZUN1dE9yQ29weShldmVudCkpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjb3B5JywgZXZlbnQgPT4gdGhpcy5oYW5kbGVDdXRPckNvcHkoZXZlbnQpKTtcblxuICAgIH1cblxuICAgIHByaXZhdGUgc3RhdGljIGhhbmRsZUN1dE9yQ29weShldmVudDogQ2xpcGJvYXJkRXZlbnQpIHtcblxuICAgICAgICBpZiAoIWV2ZW50LmNsaXBib2FyZERhdGEpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHNlbCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTtcblxuICAgICAgICBpZiAoISBzZWwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzZWwucmFuZ2VDb3VudCA8PSAwKSB7XG4gICAgICAgICAgICAvLyB0aGVyZSBhcmUgbm8gcmFuZ2VzLi4uXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB0ZXh0ID0gUmFuZ2VzLnRvVGV4dChzZWwuZ2V0UmFuZ2VBdCgwKSk7XG5cbiAgICAgICAgZXZlbnQuY2xpcGJvYXJkRGF0YS5zZXREYXRhKCd0ZXh0L3BsYWluJywgdGV4dCk7XG4gICAgICAgIGV2ZW50LmNsaXBib2FyZERhdGEuc2V0RGF0YSgndGV4dC9odG1sJywgdGV4dCk7XG4gICAgICAgIGV2ZW50LmNsaXBib2FyZERhdGEuc2V0RGF0YSgncGFzdGVkLWZyb20tcG9sYXInLCAndHJ1ZScpO1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgfVxuXG59XG4iXX0=