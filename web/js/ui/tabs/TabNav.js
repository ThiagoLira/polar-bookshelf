"use strict";
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result["default"] = mod;
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const React = __importStar(require("react"));
const Nav_1 = __importDefault(require("reactstrap/lib/Nav"));
const NavItem_1 = __importDefault(require("reactstrap/lib/NavItem"));
const NavLink_1 = __importDefault(require("reactstrap/lib/NavLink"));
const Button_1 = __importDefault(require("reactstrap/lib/Button"));
const TabButtonContextMenu_1 = require("./TabButtonContextMenu");
const TabPanes_1 = require("./TabPanes");
const TabStyles_1 = require("./TabStyles");
let tabSequence = 10000;
class TabNav extends React.Component {
    constructor(props, context) {
        super(props, context);
        this.toggle = this.toggle.bind(this);
        this.addTab = this.addTab.bind(this);
        this.closeTab = this.closeTab.bind(this);
        this.closeOtherTabs = this.closeOtherTabs.bind(this);
        this.props.addTabBinder(tab => this.addTab(tab));
        const initialTabs = this.props.initialTabs || [];
        const tabs = initialTabs.map(current => {
            return Object.assign(Object.assign({}, current), { id: tabSequence++ });
        });
        this.state = {
            activeTab: 0,
            tabs
        };
    }
    render() {
        const NavTabs = () => {
            return React.createElement(Nav_1.default, { style: TabStyles_1.TabStyles.TAB_NAV, tabs: true }, this.state.tabs.map(tab => React.createElement(NavItem_1.default, { key: tab.id },
                React.createElement(NavLink_1.default, { className: "p-0 " + (tab.id === this.state.activeTab ? "active" : "") },
                    React.createElement("div", { style: { display: 'flex' }, className: tab.id === this.state.activeTab ? "border-bottom border-primary " : "" },
                        React.createElement(TabButtonContextMenu_1.TabButtonContextMenu, { onCloseOtherTabs: () => this.closeOtherTabs(tab.id), onClose: () => this.closeTab(tab.id) },
                            React.createElement("div", { className: "mt-auto mb-auto pt-1 pb-1 pl-2 pr-1", style: { userSelect: 'none' }, onClick: () => this.toggle(tab.id) }, tab.title)),
                        React.createElement("div", { className: "mt-auto mb-auto mr-1" },
                            React.createElement(Button_1.default, { color: "light", onClick: () => this.closeTab(tab.id), className: "text-muted p-1", style: { fontSize: '14px' } },
                                React.createElement("i", { className: "fas fa-times" }))))))));
        };
        return (React.createElement("div", { className: "tab-nav" },
            React.createElement(NavTabs, null),
            React.createElement(TabPanes_1.TabPanes, { tabs: this.state.tabs, activeTab: this.state.activeTab })));
    }
    addTab(tab) {
        const newTab = Object.assign(Object.assign({}, tab), { id: tabSequence++ });
        const activeTab = newTab.id;
        this.setState(Object.assign(Object.assign({}, this.state), { tabs: [...this.state.tabs, newTab], activeTab }));
    }
    closeTab(tab) {
        const tabs = this.state.tabs.filter(current => current.id !== tab);
        this.setState(Object.assign(Object.assign({}, this.state), { tabs }));
    }
    closeOtherTabs(tab) {
        const tabs = this.state.tabs.filter(current => current.id === tab);
        this.setState(Object.assign(Object.assign({}, this.state), { tabs, activeTab: tab }));
    }
    toggle(tab) {
        if (this.state.activeTab !== tab) {
            this.setState(Object.assign(Object.assign({}, this.state), { activeTab: tab }));
        }
    }
}
exports.TabNav = TabNav;
class ExternalContent {
    constructor(href) {
        this.href = href;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGFiTmF2LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiVGFiTmF2LnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQSw2Q0FBK0I7QUFDL0IsNkRBQXFDO0FBQ3JDLHFFQUE2QztBQUM3QyxxRUFBNkM7QUFFN0MsbUVBQTJDO0FBQzNDLGlFQUE0RDtBQUM1RCx5Q0FBb0M7QUFDcEMsMkNBQXNDO0FBRXRDLElBQUksV0FBVyxHQUFXLEtBQUssQ0FBQztBQU9oQyxNQUFhLE1BQU8sU0FBUSxLQUFLLENBQUMsU0FBeUI7SUFFdkQsWUFBWSxLQUFhLEVBQUUsT0FBWTtRQUNuQyxLQUFLLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBRXRCLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDckMsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNyQyxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3pDLElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFckQsSUFBSSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFFakQsTUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxXQUFXLElBQUksRUFBRSxDQUFFO1FBRWxELE1BQU0sSUFBSSxHQUFHLFdBQVcsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLEVBQUU7WUFDbkMsdUNBQ08sT0FBTyxLQUNWLEVBQUUsRUFBRSxXQUFXLEVBQUUsSUFDbkI7UUFDTixDQUFD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QUVuRSxJQUFJLENBQUMsUUFBUSxpQ0FBSyxJQUFJLENBQUMsS0FBSyxLQUFFLElBQUksSUFBRSxDQUFDO0lBRXpDLENBQUM7SUFFTyxjQUFjLENBQUMsR0FBVztRQUU5QixNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsRUFBRSxLQUFLLEdBQUcsQ0FBQyxDQUFDO1FBQ25FLElBQUksQ0FBQyxRQUFRLGlDQUFLLElBQUksQ0FBQyxLQUFLLEtBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxHQUFHLElBQUUsQ0FBQztJQUV6RCxDQUFDO0lBRU8sTUFBTSxDQUFDLEdBQVc7UUFFdEIsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsS0FBSyxHQUFHLEVBQUU7WUFDOUIsSUFBSSxDQUFDLFFBQVEsaUNBQUssSUFBSSxDQUFDLEtBQUssS0FBRSxTQUFTLEVBQUUsR0FBRyxJQUFFLENBQUM7U0FDbEQ7SUFFTCxDQUFDO0NBRUo7QUFuSkQsd0JBbUpDO0FBd0NELE1BQU0sZUFBZTtJQUVqQixZQUE0QixJQUFZO1FBQVosU0FBSSxHQUFKLElBQUksQ0FBUTtJQUV4QyxDQUFDO0NBQ0oiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgTmF2IGZyb20gJ3JlYWN0c3RyYXAvbGliL05hdic7XG5pbXBvcnQgTmF2SXRlbSBmcm9tICdyZWFjdHN0cmFwL2xpYi9OYXZJdGVtJztcbmltcG9ydCBOYXZMaW5rIGZyb20gJ3JlYWN0c3RyYXAvbGliL05hdkxpbmsnO1xuaW1wb3J0IHtDaGFubmVsQ291cGxlcn0gZnJvbSAnLi4vLi4vdXRpbC9DaGFubmVscyc7XG5pbXBvcnQgQnV0dG9uIGZyb20gJ3JlYWN0c3RyYXAvbGliL0J1dHRvbic7XG5pbXBvcnQge1RhYkJ1dHRvbkNvbnRleHRNZW51fSBmcm9tICcuL1RhYkJ1dHRvbkNvbnRleHRNZW51JztcbmltcG9ydCB7VGFiUGFuZXN9IGZyb20gJy4vVGFiUGFuZXMnO1xuaW1wb3J0IHtUYWJTdHlsZXN9IGZyb20gJy4vVGFiU3R5bGVzJztcblxubGV0IHRhYlNlcXVlbmNlOiBudW1iZXIgPSAxMDAwMDtcblxuLy8gVE9ET1xuLy9cbi8vIC0gZml0IHRoZSBzY3JlZW4gcHJvcGVybHkgaW5jbHVkaW5nIHRoZSB3ZWJ2aWV3IGNvbnRlbnRcbi8vIC0gZGlzYWJsZSB0aGUgYWJpbGl0eSB0byBjbG9zZSB0aGUgcHJpbWFyeSB0YWJcblxuZXhwb3J0IGNsYXNzIFRhYk5hdiBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxJUHJvcHMsIElTdGF0ZT4ge1xuXG4gICAgY29uc3RydWN0b3IocHJvcHM6IElQcm9wcywgY29udGV4dDogYW55KSB7XG4gICAgICAgIHN1cGVyKHByb3BzLCBjb250ZXh0KTtcblxuICAgICAgICB0aGlzLnRvZ2dsZSA9IHRoaXMudG9nZ2xlLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuYWRkVGFiID0gdGhpcy5hZGRUYWIuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5jbG9zZVRhYiA9IHRoaXMuY2xvc2VUYWIuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5jbG9zZU90aGVyVGFicyA9IHRoaXMuY2xvc2VPdGhlclRhYnMuYmluZCh0aGlzKTtcblxuICAgICAgICB0aGlzLnByb3BzLmFkZFRhYkJpbmRlcih0YWIgPT4gdGhpcy5hZGRUYWIodGFiKSk7XG5cbiAgICAgICAgY29uc3QgaW5pdGlhbFRhYnMgPSB0aGlzLnByb3BzLmluaXRpYWxUYWJzIHx8IFtdIDtcblxuICAgICAgICBjb25zdCB0YWJzID0gaW5pdGlhbFRhYnMubWFwKGN1cnJlbnQgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAuLi5jdXJyZW50LFxuICAgICAgICAgICAgICAgIGlkOiB0YWJTZXF1ZW5jZSsrXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgYWN0aXZlVGFiOiAwLFxuICAgICAgICAgICAgdGFic1xuICAgICAgICAgICAgLy8gdGFiczogW1xuICAgICAgICAgICAgLy8gICAgIHtcbiAgICAgICAgICAgIC8vICAgICAgICAgaWQ6IDAsXG4gICAgICAgICAgICAvLyAgICAgICAgIHRpdGxlOiBcIlJlcG9zaXRvcnlcIixcbiAgICAgICAgICAgIC8vICAgICAgICAgY29udGVudDogPGRpdj5UaGlzIGlzIHRoZSBmaXJzdCBwYWdlIGNvbnRlbnQ8L2Rpdj5cbiAgICAgICAgICAgIC8vICAgICB9LFxuICAgICAgICAgICAgLy8gICAgIHtcbiAgICAgICAgICAgIC8vICAgICAgICAgaWQ6IDEsXG4gICAgICAgICAgICAvLyAgICAgICAgIHRpdGxlOiBcIkNOTlwiLFxuICAgICAgICAgICAgLy8gICAgICAgICBjb250ZW50OiAnaHR0cDovL2Nubi5jb20nXG4gICAgICAgICAgICAvLyAgICAgfSxcbiAgICAgICAgICAgIC8vIF1cbiAgICAgICAgfTtcblxuICAgIH1cblxuICAgIHB1YmxpYyByZW5kZXIoKSB7XG5cbiAgICAgICAgY29uc3QgTmF2VGFicyA9ICgpID0+IHtcblxuICAgICAgICAgICAgcmV0dXJuIDxOYXYgc3R5bGU9e1RhYlN0eWxlcy5UQUJfTkFWfSB0YWJzPlxuXG4gICAgICAgICAgICAgICAge3RoaXMuc3RhdGUudGFicy5tYXAodGFiID0+XG5cbiAgICAgICAgICAgICAgICAgICAgPE5hdkl0ZW0ga2V5PXt0YWIuaWR9PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICA8TmF2TGlua1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17XCJwLTAgXCIgKyAodGFiLmlkID09PSB0aGlzLnN0YXRlLmFjdGl2ZVRhYiA/IFwiYWN0aXZlXCIgOiBcIlwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPXt7ZGlzcGxheTogJ2ZsZXgnfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17dGFiLmlkID09PSB0aGlzLnN0YXRlLmFjdGl2ZVRhYiA/IFwiYm9yZGVyLWJvdHRvbSBib3JkZXItcHJpbWFyeSBcIiA6IFwiXCJ9PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWJCdXR0b25Db250ZXh0TWVudSBvbkNsb3NlT3RoZXJUYWJzPXsoKSA9PiB0aGlzLmNsb3NlT3RoZXJUYWJzKHRhYi5pZCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsb3NlPXsoKSA9PiB0aGlzLmNsb3NlVGFiKHRhYi5pZCl9PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm10LWF1dG8gbWItYXV0byBwdC0xIHBiLTEgcGwtMiBwci0xXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3t1c2VyU2VsZWN0OiAnbm9uZSd9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB0aGlzLnRvZ2dsZSh0YWIuaWQpfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dGFiLnRpdGxlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UYWJCdXR0b25Db250ZXh0TWVudT5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm10LWF1dG8gbWItYXV0byBtci0xXCI+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b24gY29sb3I9XCJsaWdodFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHRoaXMuY2xvc2VUYWIodGFiLmlkKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidGV4dC1tdXRlZCBwLTFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e2ZvbnRTaXplOiAnMTRweCd9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYXMgZmEtdGltZXNcIj48L2k+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgPC9OYXZMaW5rPlxuXG4gICAgICAgICAgICAgICAgICAgIDwvTmF2SXRlbT5cblxuICAgICAgICAgICAgICAgICAgICl9XG5cbiAgICAgICAgICAgIDwvTmF2PjtcblxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiAoXG5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGFiLW5hdlwiPlxuXG4gICAgICAgICAgICAgICAgICAgIDxOYXZUYWJzLz5cblxuICAgICAgICAgICAgICAgICAgICA8VGFiUGFuZXMgdGFicz17dGhpcy5zdGF0ZS50YWJzfSBhY3RpdmVUYWI9e3RoaXMuc3RhdGUuYWN0aXZlVGFifS8+XG5cbiAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICk7XG5cbiAgICB9XG5cbiAgICBwcml2YXRlIGFkZFRhYih0YWI6IFRhYkluaXQpIHtcblxuICAgICAgICBjb25zdCBuZXdUYWIgPSB7XG4gICAgICAgICAgICAuLi50YWIsXG4gICAgICAgICAgICBpZDogdGFiU2VxdWVuY2UrK1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIG1ha2UgaXQgdGhlIGFjdGl2ZVRhYiBieSBkZWZhdWx0XG4gICAgICAgIGNvbnN0IGFjdGl2ZVRhYiA9IG5ld1RhYi5pZDtcblxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIC4uLnRoaXMuc3RhdGUsXG4gICAgICAgICAgICB0YWJzOiBbLi4udGhpcy5zdGF0ZS50YWJzLCBuZXdUYWJdLFxuICAgICAgICAgICAgYWN0aXZlVGFiXG4gICAgICAgIH0pO1xuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjbG9zZVRhYih0YWI6IG51bWJlcikge1xuXG4gICAgICAgIC8vIFRPRE86IHdlIGhhdmUgdG8gcGljayBhIG5ldyBhY3RpdmVUYWIgbm93Li4uXG5cbiAgICAgICAgY29uc3QgdGFicyA9IHRoaXMuc3RhdGUudGFicy5maWx0ZXIoY3VycmVudCA9PiBjdXJyZW50LmlkICE9PSB0YWIpO1xuXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoey4uLnRoaXMuc3RhdGUsIHRhYnN9KTtcblxuICAgIH1cblxuICAgIHByaXZhdGUgY2xvc2VPdGhlclRhYnModGFiOiBudW1iZXIpIHtcblxuICAgICAgICBjb25zdCB0YWJzID0gdGhpcy5zdGF0ZS50YWJzLmZpbHRlcihjdXJyZW50ID0+IGN1cnJlbnQuaWQgPT09IHRhYik7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoey4uLnRoaXMuc3RhdGUsIHRhYnMsIGFjdGl2ZVRhYjogdGFifSk7XG5cbiAgICB9XG5cbiAgICBwcml2YXRlIHRvZ2dsZSh0YWI6IG51bWJlcikge1xuXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmFjdGl2ZVRhYiAhPT0gdGFiKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsuLi50aGlzLnN0YXRlLCBhY3RpdmVUYWI6IHRhYn0pO1xuICAgICAgICB9XG5cbiAgICB9XG5cbn1cblxuXG5pbnRlcmZhY2UgSVByb3BzIHtcblxuICAgIHJlYWRvbmx5IGluaXRpYWxUYWJzPzogUmVhZG9ubHlBcnJheTxUYWJJbml0PjtcblxuICAgIHJlYWRvbmx5IGFkZFRhYkJpbmRlcjogQ2hhbm5lbENvdXBsZXI8VGFiSW5pdD47XG59XG5cbmludGVyZmFjZSBJU3RhdGUge1xuICAgIHJlYWRvbmx5IGFjdGl2ZVRhYjogbnVtYmVyO1xuICAgIHJlYWRvbmx5IHRhYnM6IFJlYWRvbmx5QXJyYXk8VGFiPjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUYWJJbml0IHtcblxuICAgIHJlYWRvbmx5IHRpdGxlOiBzdHJpbmc7XG5cbiAgICAvKipcbiAgICAgKiBXaGF0IHdlIHNob3VsZCBiZSBkaXNwbGF5aW5nIGluIHRoZSB0YWIuXG4gICAgICovXG4gICAgcmVhZG9ubHkgY29udGVudDogSlNYLkVsZW1lbnQgfCBzdHJpbmc7XG5cbn1cblxuLyoqXG4gKiBPdXIgaGlnaCBsZXZlbCBpbnRlcmZhY2UgZm9yIGEgdGFiXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVGFiIGV4dGVuZHMgVGFiSW5pdCB7XG5cbiAgICByZWFkb25seSBpZDogbnVtYmVyO1xuXG59XG5cbi8qKlxuICogVXNlZCB0byBsb2FkIGNvbnRlbnQgZXh0ZXJuYWxseSB2aWEgYSBXZWJWaWV3IGJ1dCBJIG5lZWQgdG8gZmlndXJlIG91dCBpZlxuICogdGhpcyBpcyBldmVuIGRvYWJsZSBidXQgSSB0aGluayBpZiBJIHNldCB0aGUgaGVpZ2h0IGFzIDEwMHZoIHRoYXQgaXQgd2lsbFxuICogd29yayBwcm9wZXJseS5cbiAqL1xuY2xhc3MgRXh0ZXJuYWxDb250ZW50IHtcblxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyByZWFkb25seSBocmVmOiBzdHJpbmcpIHtcblxuICAgIH1cbn1cbiJdfQ==