"use strict";
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result["default"] = mod;
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const React = __importStar(require("react"));
const react_table_1 = __importDefault(require("react-table"));
const ExtendedReactTable_1 = require("../util/ExtendedReactTable");
const AnnotationPreview_1 = require("./AnnotationPreview");
class AnnotationRepoTable extends ExtendedReactTable_1.ExtendedReactTable {
    constructor(props, context) {
        super(props, context);
        this.persistenceLayerManager = this.props.persistenceLayerManager;
        this.state = {};
    }
    onSelected(selected, repoAnnotation) {
        this.setState(Object.assign(Object.assign({}, this.state), { selected, repoAnnotation }));
        this.props.onSelected(repoAnnotation);
    }
    render() {
        const { data } = this.props;
        return (React.createElement("div", { id: "doc-repo-table" },
            React.createElement("div", { id: "doc-table" },
                React.createElement(react_table_1.default, { data: [...data], columns: [
                        {
                            Header: '',
                            accessor: 'title',
                            headerStyle: { display: 'none' },
                            style: { whiteSpace: 'normal' },
                            Cell: (row) => {
                                const id = 'annotation-title' + row.index;
                                const annotation = row.original;
                                return (React.createElement(AnnotationPreview_1.AnnotationPreview, { id: id, text: annotation.text, img: annotation.img, color: annotation.color, created: annotation.created }));
                            }
                        },
                        {
                            Header: 'Created',
                            accessor: 'created',
                            show: false,
                        },
                    ], defaultPageSize: 50, style: { height: '100%' }, showPageSizeOptions: false, noDataText: "No annotations available.", className: "-striped -highlight", defaultSorted: [
                        {
                            id: "created",
                            desc: true
                        }
                    ], getTrProps: (state, rowInfo) => {
                        const doSelect = () => {
                            if (rowInfo && rowInfo.original) {
                                const repoAnnotation = rowInfo.original;
                                this.onSelected(rowInfo.viewIndex, repoAnnotation);
                            }
                            else {
                            }
                        };
                        return {
                            onClick: (e) => {
                                doSelect();
                            },
                            onFocus: () => {
                                doSelect();
                            },
                            tabIndex: rowInfo ? rowInfo.viewIndex + 1 : undefined,
                            onKeyDown: (e) => {
                            },
                            style: {
                                borderWidth: '1px',
                                borderStyle: 'solid',
                                borderColor: rowInfo && rowInfo.viewIndex === this.state.selected ? '#00afec' : 'white',
                            }
                        };
                    }, getTdProps: (state, rowInfo, column, instance) => {
                        const singleClickColumns = [];
                        if (!singleClickColumns.includes(column.id)) {
                            return {
                                onDoubleClick: (e) => {
                                }
                            };
                        }
                        if (singleClickColumns.includes(column.id)) {
                            return {
                                onClick: ((e, handleOriginal) => {
                                    if (handleOriginal) {
                                        handleOriginal();
                                    }
                                })
                            };
                        }
                        return {};
                    } }))));
    }
}
exports.default = AnnotationRepoTable;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQW5ub3RhdGlvblJlcG9UYWJsZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkFubm90YXRpb25SZXBvVGFibGUudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBLDZDQUErQjtBQUMvQiw4REFBcUM7QUFNckMsbUVBQWdGO0FBQ2hGLDJEQUFzRDtBQUd0RCxNQUFxQixtQkFBb0IsU0FBUSx1Q0FBa0M7SUFJL0UsWUFBWSxLQUFhLEVBQUUsT0FBWTtRQUNuQyxLQUFLLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBRXRCLElBQUksQ0FBQyx1QkFBdUIsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLHVCQUF1QixDQUFDO1FBRWxFLElBQUksQ0FBQyxLQUFLLEdBQUcsRUFDWixDQUFDO0lBRU4sQ0FBQztJQUVNLFVBQVUsQ0FBQyxRQUFnQixFQUNoQixjQUE4QjtRQUU1QyxJQUFJLENBQUMsUUFBUSxpQ0FBSyxJQUFJLENBQUMsS0FBSyxLQUFFLFFBQVEsRUFBRSxjQUFjLElBQUUsQ0FBQztRQUN6RCxJQUFJLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxjQUFjLENBQUMsQ0FBQztJQUUxQyxDQUFDO0lBRU0sTUFBTTtRQUNULE1BQU0sRUFBRSxJQUFJLEVBQUUsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO1FBRTVCLE9BQU8sQ0FFSCw2QkFBSyxFQUFFLEVBQUMsZ0JBQWdCO1lBRXBCLDZCQUFLLEVBQUUsRUFBQyxXQUFXO2dCQUVmLG9CQUFDLHFCQUFVLElBQ1AsSUFBSSxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsRUFFZixPQUFPLEVBQ0g7d0JBaUJJOzRCQUNJLE1BQU0sRUFBRSxFQUFFOzRCQUNWLFFBQVEsRUFBRSxPQUFPOzRCQUNqQixXQUFXLEVBQUUsRUFBQyxPQUFPLEVBQUUsTUFBTSxFQUFDOzRCQUM5QixLQUFLLEVBQUUsRUFBQyxVQUFVLEVBQUUsUUFBUSxFQUFDOzRCQUM3QixJQUFJLEVBQUUs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QUUsQ0FBQztvQkFFZCxDQUFDLEdBRUgsQ0FFQSxDQUVKLENBRVQsQ0FBQztJQUNOLENBQUM7Q0FFSjtBQXZORCxzQ0F1TkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUmVhY3RUYWJsZSBmcm9tIFwicmVhY3QtdGFibGVcIjtcbmltcG9ydCB7SURvY0luZm99IGZyb20gJ3BvbGFyLXNoYXJlZC9zcmMvbWV0YWRhdGEvSURvY0luZm8nO1xuaW1wb3J0IHtJRXZlbnREaXNwYXRjaGVyfSBmcm9tICcuLi8uLi8uLi8uLi93ZWIvanMvcmVhY3Rvci9TaW1wbGVSZWFjdG9yJztcbmltcG9ydCB7UGVyc2lzdGVuY2VMYXllck1hbmFnZXJ9IGZyb20gJy4uLy4uLy4uLy4uL3dlYi9qcy9kYXRhc3RvcmUvUGVyc2lzdGVuY2VMYXllck1hbmFnZXInO1xuaW1wb3J0IHtSZXBvRG9jTWV0YU1hbmFnZXJ9IGZyb20gJy4uL1JlcG9Eb2NNZXRhTWFuYWdlcic7XG5pbXBvcnQge1JlcG9Eb2NNZXRhTG9hZGVyfSBmcm9tICcuLi9SZXBvRG9jTWV0YUxvYWRlcic7XG5pbXBvcnQge0V4dGVuZGVkUmVhY3RUYWJsZSwgSVJlYWN0VGFibGVTdGF0ZX0gZnJvbSAnLi4vdXRpbC9FeHRlbmRlZFJlYWN0VGFibGUnO1xuaW1wb3J0IHtBbm5vdGF0aW9uUHJldmlld30gZnJvbSAnLi9Bbm5vdGF0aW9uUHJldmlldyc7XG5pbXBvcnQge0lEb2NBbm5vdGF0aW9ufSBmcm9tIFwiLi4vLi4vLi4vLi4vd2ViL2pzL2Fubm90YXRpb25fc2lkZWJhci9Eb2NBbm5vdGF0aW9uXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFubm90YXRpb25SZXBvVGFibGUgZXh0ZW5kcyBFeHRlbmRlZFJlYWN0VGFibGU8SVByb3BzLCBJU3RhdGU+IHtcblxuICAgIHByaXZhdGUgcmVhZG9ubHkgcGVyc2lzdGVuY2VMYXllck1hbmFnZXI6IFBlcnNpc3RlbmNlTGF5ZXJNYW5hZ2VyO1xuXG4gICAgY29uc3RydWN0b3IocHJvcHM6IElQcm9wcywgY29udGV4dDogYW55KSB7XG4gICAgICAgIHN1cGVyKHByb3BzLCBjb250ZXh0KTtcblxuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlTGF5ZXJNYW5hZ2VyID0gdGhpcy5wcm9wcy5wZXJzaXN0ZW5jZUxheWVyTWFuYWdlcjtcblxuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICB9O1xuXG4gICAgfVxuXG4gICAgcHVibGljIG9uU2VsZWN0ZWQoc2VsZWN0ZWQ6IG51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICByZXBvQW5ub3RhdGlvbjogSURvY0Fubm90YXRpb24pIHtcblxuICAgICAgICB0aGlzLnNldFN0YXRlKHsuLi50aGlzLnN0YXRlLCBzZWxlY3RlZCwgcmVwb0Fubm90YXRpb259KTtcbiAgICAgICAgdGhpcy5wcm9wcy5vblNlbGVjdGVkKHJlcG9Bbm5vdGF0aW9uKTtcblxuICAgIH1cblxuICAgIHB1YmxpYyByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IHsgZGF0YSB9ID0gdGhpcy5wcm9wcztcblxuICAgICAgICByZXR1cm4gKFxuXG4gICAgICAgICAgICA8ZGl2IGlkPVwiZG9jLXJlcG8tdGFibGVcIj5cblxuICAgICAgICAgICAgICAgIDxkaXYgaWQ9XCJkb2MtdGFibGVcIj5cblxuICAgICAgICAgICAgICAgICAgICA8UmVhY3RUYWJsZVxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YT17Wy4uLmRhdGFdfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaGVhZGVyUHJvcHM9e3tkaXNwbGF5OiAnbm9uZSd9fVxuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1ucz17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICBIZWFkZXI6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgYWNjZXNzb3I6ICd0eXBlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIG1heFdpZHRoOiAzMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIENlbGw6IChyb3c6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIDxBbm5vdGF0aW9uSWNvbiB0eXBlPXtyb3cub3JpZ2luYWwudHlwZX0gY29sb3I9e3Jvdy5vcmlnaW5hbC5jb2xvcn0vPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIZWFkZXI6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXNzb3I6ICd0aXRsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJTdHlsZToge2Rpc3BsYXk6ICdub25lJ30sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZToge3doaXRlU3BhY2U6ICdub3JtYWwnfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENlbGw6IChyb3c6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlkID0gJ2Fubm90YXRpb24tdGl0bGUnICsgcm93LmluZGV4O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYW5ub3RhdGlvbjogSURvY0Fubm90YXRpb24gPSByb3cub3JpZ2luYWw7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBbm5vdGF0aW9uUHJldmlldyBpZD17aWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0PXthbm5vdGF0aW9uLnRleHR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWc9e2Fubm90YXRpb24uaW1nfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I9e2Fubm90YXRpb24uY29sb3J9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkPXthbm5vdGF0aW9uLmNyZWF0ZWR9Lz5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIZWFkZXI6ICdDcmVhdGVkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFjY2Vzc29yOiAocm93OiBhbnkpID0+IHJvdy5hZGRlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY2Vzc29yOiAnY3JlYXRlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93OiBmYWxzZSxcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICBpZDogJ3RhZ3MnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgSGVhZGVyOiAnVGFncycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICBhY2Nlc3NvcjogJycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICBzaG93OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgd2lkdGg6IDIwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIENlbGw6IChyb3c6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIC8vIFRPRE86IHVzZSA8Rm9ybWF0dGVkVGFncz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBjb25zdCB0YWdzOiB7W2lkOiBzdHJpbmddOiBUYWd9ID0gcm93Lm9yaWdpbmFsLnRhZ3M7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgY29uc3QgZm9ybWF0dGVkID0gT2JqZWN0LnZhbHVlcyh0YWdzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAubWFwKHRhZyA9PiB0YWcubGFiZWwpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIC5zb3J0KClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgLmpvaW4oXCIsIFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICA8ZGl2Pntmb3JtYXR0ZWR9PC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gfSxcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF19XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRQYWdlU2l6ZT17NTB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e2hlaWdodDogJzEwMCUnfX1cbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dQYWdlU2l6ZU9wdGlvbnM9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgbm9EYXRhVGV4dD1cIk5vIGFubm90YXRpb25zIGF2YWlsYWJsZS5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiLXN0cmlwZWQgLWhpZ2hsaWdodFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0U29ydGVkPXtbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogXCJjcmVhdGVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2M6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBdfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc29ydGVkPXtbe1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIGlkOiAnYWRkZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIGRlc2M6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIH1dfVxuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0VHJQcm9wcz17KHN0YXRlOiBhbnksIHJvd0luZm86IGFueSkgPT4ge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZG9TZWxlY3QgPSAoKSA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJvd0luZm8gJiYgcm93SW5mby5vcmlnaW5hbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVwb0Fubm90YXRpb24gPSByb3dJbmZvLm9yaWdpbmFsIGFzIElEb2NBbm5vdGF0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vblNlbGVjdGVkKHJvd0luZm8udmlld0luZGV4IGFzIG51bWJlciwgcmVwb0Fubm90YXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBpcyBub3QgYSByb3cgd2l0aCBkYXRhIGFuZCBqdXN0IGFuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlbXB0eSByb3cgYW5kIHdlIGhhdmUgdG8gaGFuZGxlIHRoaXMgb3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdlIHdpbGwgZ2V0IGFuIGV4Y2VwdGlvbi5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljazogKGU6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9TZWxlY3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkZvY3VzOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb1NlbGVjdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYkluZGV4OiByb3dJbmZvID8gKHJvd0luZm8udmlld0luZGV4IGFzIG51bWJlcikgKyAxIDogdW5kZWZpbmVkLFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uS2V5RG93bjogKGU6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyB3b3JrcyBidXQgSSBuZWVkIHRvIGhhbmRsZSB0aGUgYXJyb3cga2V5cyBwcm9wZXJseS4uLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJvbiBrZXkgcHJlc3M6IFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyV2lkdGg6ICcxcHgnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyU3R5bGU6ICdzb2xpZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXJDb2xvcjogcm93SW5mbyAmJiByb3dJbmZvLnZpZXdJbmRleCA9PT0gdGhpcy5zdGF0ZS5zZWxlY3RlZCA/ICcjMDBhZmVjJyA6ICd3aGl0ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb2xvcjogcm93SW5mbyAmJiByb3dJbmZvLnZpZXdJbmRleCA9PT0gdGhpcy5zdGF0ZS5zZWxlY3RlZCA/ICd3aGl0ZScgOiAnYmxhY2snLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGdldFRkUHJvcHM9eyhzdGF0ZTogYW55LCByb3dJbmZvOiBhbnksIGNvbHVtbjogYW55LCBpbnN0YW5jZTogYW55KSA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzaW5nbGVDbGlja0NvbHVtbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISBzaW5nbGVDbGlja0NvbHVtbnMuaW5jbHVkZXMoY29sdW1uLmlkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkRvdWJsZUNsaWNrOiAoZTogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5vbkRvY3VtZW50TG9hZFJlcXVlc3RlZChyb3dJbmZvLm9yaWdpbmFsLmZpbmdlcnByaW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJvd0luZm8ub3JpZ2luYWwuZmlsZW5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcm93SW5mby5vcmlnaW5hbC5oYXNoY29kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNpbmdsZUNsaWNrQ29sdW1ucy5pbmNsdWRlcyhjb2x1bW4uaWQpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljazogKChlOiBhbnksIGhhbmRsZU9yaWdpbmFsPzogKCkgPT4gdm9pZCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5oYW5kbGVUb2dnbGVGaWVsZChyb3dJbmZvLm9yaWdpbmFsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbHVtbi5pZCkgLmNhdGNoKGVyciA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGxvZy5lcnJvcihcIkNvdWxkIG5vdCBoYW5kbGUgdG9nZ2xlOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFwiLCBlcnIpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYW5kbGVPcmlnaW5hbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBuZWVkZWQgZm9yIHJlYWN0IHRhYmxlIHRvXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZ1bmN0aW9uIHByb3Blcmx5LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVPcmlnaW5hbCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9fVxuXG4gICAgICAgICAgICAgICAgICAgIC8+XG5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgKTtcbiAgICB9XG5cbn1cblxuaW50ZXJmYWNlIElQcm9wcyB7XG5cbiAgICByZWFkb25seSBwZXJzaXN0ZW5jZUxheWVyTWFuYWdlcjogUGVyc2lzdGVuY2VMYXllck1hbmFnZXI7XG5cbiAgICByZWFkb25seSB1cGRhdGVkRG9jSW5mb0V2ZW50RGlzcGF0Y2hlcjogSUV2ZW50RGlzcGF0Y2hlcjxJRG9jSW5mbz47XG5cbiAgICByZWFkb25seSByZXBvRG9jTWV0YU1hbmFnZXI6IFJlcG9Eb2NNZXRhTWFuYWdlcjtcblxuICAgIHJlYWRvbmx5IHJlcG9Eb2NNZXRhTG9hZGVyOiBSZXBvRG9jTWV0YUxvYWRlcjtcblxuICAgIHJlYWRvbmx5IG9uU2VsZWN0ZWQ6IChyZXBvQW5ub3RhdGlvbjogSURvY0Fubm90YXRpb24pID0+IHZvaWQ7XG5cbiAgICByZWFkb25seSBkYXRhOiBSZWFkb25seUFycmF5PElEb2NBbm5vdGF0aW9uPjtcblxufVxuXG5pbnRlcmZhY2UgSVN0YXRlIGV4dGVuZHMgSVJlYWN0VGFibGVTdGF0ZSB7XG5cblxuICAgIC8qKlxuICAgICAqIFRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgcmVwbyBhbm5vdGF0aW9uLlxuICAgICAqL1xuICAgIHJlcG9Bbm5vdGF0aW9uPzogSURvY0Fubm90YXRpb247XG5cbn1cbiJdfQ==